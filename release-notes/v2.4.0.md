# v2.4.0 Release Notes

_Date: 2025-09-26_

## Highlights
- **Persistent Module Insights**: Values and Strengths modules now store structured insight blobs (`ValueResult.insights`, `StrengthProfile`) so downstream services can correlate buckets, personality inferences, and top strengths without re-running analysis.
- **Strengths Session Resilience**: Session saves automatically upsert `StrengthProfile`, attach Google user metadata to each strength entry, and maintain `UserSession.metadata` for stage tracking.
- **Landing Page Sign-in CTA**: Added a Google sign-in/out control on the homepage header to keep users authenticated before starting any discovery path.

## Bug Fixes / Reliability
- Resolved save failures caused by Prisma schema drift on Render by aligning the remote database with the repo schema (new columns, indexes, and tables).
- Hardened admin access checks and stats endpoints to cope with historical placeholder users and mixed session schemas.

## Deployment Notes
- Run `npx prisma db push --schema=prisma/schema.postgres.prisma --accept-data-loss` on Render (or apply equivalent SQL) to add the new columns and the `StrengthProfile` table.
- Regenerate Prisma client: `npx prisma generate --schema=prisma/schema.postgres.prisma`.
- After deployment, verify that both `/api/discover/values/results` and `/api/session/save` return 200 and populate the new insight fields.

## Follow-up
- Automate non-destructive migrations to avoid manual `--accept-data-loss` steps when working through Prisma Accelerate.
- Extend the documented insight pattern to upcoming modules (Life Themes, Enneagram) for consistent cross-module analytics.
